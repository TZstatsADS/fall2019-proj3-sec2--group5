---
title: "eyelid_feature"
author: "Qiwen Gao qg2165"
date: "10/29/2019"
output:
  html_document:
    info_print: paged
  html_notebook: default
  pinfo_document: default
  word_document: default
---

```{r}
#info <- read.csv("../data/train_set/label.csv")
#load("../output/fiducial_pt_list.Rdata")
#library(readxl)

# A function to plot histogram of distribution of pairwise distance for each emotion
# input: emotion index, first point, second point, vertical or horizontal distance
# output: histogram of distance distribution
eyelid<-list()
for (i in 1:2500){
  eyelid[[i]]<-fiducial_pt_list[[i]][c(2,6,19,23),]
}

eyelid_histogram_by_emotion <- function(emotion_idx){
    indices <- info[info$emotion_idx == emotion_idx, 'Index']
    emotion <- as.character(info[info$emotion_idx == emotion_idx, 'emotion_cat'])[1]
    eyelid_area <- function(idx){
    return(polyarea(x=c(eyelid[[idx]][1,1], eyelid[[idx]][2,1],eyelid[[idx]][3,1],eyelid[[idx]][4,1],eyelid[[idx]][1,1]),y=c(eyelid[[idx]][1,2], eyelid[[idx]][2,2],eyelid[[idx]][3,2],eyelid[[idx]][4,2],eyelid[[idx]][1,2])))
  
}
    eyelid_area_distribution <- sapply(indices, eyelid_area)
    #jpeg(paste(c('../output/hist', emotion_idx,"_", pt1, "_", pt2, '.jpg'), collapse = ''),
    #width = 500, height = 375)
    hist(eyelid_area_distribution, xlab = "area", 
         main = paste(c(emotion, "eyelid area"),collapse = " ")) 
    abline(v = mean(eyelid_area_distribution))
    #dev.off()
}

# A function to generalize "dist_histogram_by_emotion" to all emotions 


#lefteye_area_dist_histogram <- function(){
  lapply(1:22, eyelid_histogram_by_emotion)

# }



```